

### دستورات

ایجاد سرویس جدید در سوارم

docker service create


لیست سرویس های فعال

docker service ls


نمایش رپلیکا ها و وضعیت اجرای هر task

docker service ps service-name


حذف سرویس از سوارم

docker service rm service-name



---


### مفهوم اسکیل رپلیکا


وقتی میخوایم تعداد اینستنس های یه سرویس کم یا زیاد کنیم.


docker service scale web=5

سوارم رپلیکا هارو خودش در بین نود ها توزیع میکنه

---


### docker service update

### برای تغییر image:

`docker service update --image nginx:1.25 web`

### برای تغییر تعداد replica (بدون scale):


`docker service update --replicas 4 web`


---
### حذف و Force update سرویس‌ها

 حذف:

`docker service rm web`

Force update (برای مثال، وقتی فقط config تغییر کرده یا می‌خوای همه taskها ری‌استارت بشن):

`docker service update --force web`

---

deploy:
  restart_policy:
    condition: on-failure
    delay: 5s
    max_attempts: 3
    window: 30s




healthcheck:
  test: ["CMD", "wget", "--spider", "-q", "http://localhost"]
  interval: 30s
  timeout: 10s
  retries: 3



---
## Service Constraints and Placement Preferences

برای مشخص کردن اینکه یک سرویس فقط روی نود خاصی اجرا بشه:


`docker service create \   --name backend \   --constraint 'node.hostname == node2' \   redis`

در `stack.yml`:


`deploy:   placement:     constraints:       - node.role == worker       - node.hostname != node3`

Placement preferences:

`placement:   preferences:     - spread: node.labels.zone`

---


|دستور|کاربرد|
|---|---|
|`docker service inspect <name>`|جزئیات کامل یک سرویس (JSON)|
|`--pretty`|نمایش خلاصه‌ی قابل‌خواندن|
|`docker service logs <name>`|لاگ‌های سرویس (نیاز به تنظیمات log driver)|
|`docker service ps <name>`|وضعیت replicaها|
|`docker events`|دریافت رویدادهای real-time مربوط به سرویس‌ها، کانتینرها و نودها|